{
  "hash": "c6038a03b227dcada849786e3103b202",
  "result": {
    "markdown": "---\ntitle: \"Deep Dive Expression: Checking Apul miR-100 multi-binding\"\nauthor: \"Kathleen Durkin\"\ndate: \"2025-11-20\"\ncategories: [\"E5-coral\"]\nformat:\n  html:\n    toc: true\nexecute: \n  eval: TRUE\nengine: knitr\nbibliography: ../../../references.bib\n---\n\n\nThere are scattered instances across all three DDE species of an miRNA having multiple putative binding sites (\\<10) in a single gene, usually appearing in the CDS region (covered in detail [here](https://github.com/urol-e5/deep-dive-expression/blob/main/M-multi-species/code/04.2-miRNA-comparison-targets-FE.md)). However, there is one instance of a remarkably high number of binding sites -- in *A. pulchra*, miR-100 has a remarkable **74** putative binding sites in the CDS of the gene **FUN_014449**. Frankly, this seems like a suspiciously high number (eg., maybe all the sites are just slight variants shifted by 1nt or something), so let's double check it's real.\n\nLook at the [Apul CDS miRanda+PCC results](https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/D-Apul/output/09.01-Apul-mRNA-miRNA-interactions-CDS_5UTR/miRanda_PCC_miRNA_CDS.csv)\n\nThe \"raw\" (ShortStack-assigned) ID for miR-100 in Apul is `Cluster_18728`\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'dplyr' was built under R version 4.2.3\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmir <- read.csv(\"https://gannet.fish.washington.edu/kdurkin1/ravenbackups/deep-dive-expression/D-Apul/output/09.01-Apul-mRNA-miRNA-interactions-CDS_5UTR/miRanda_PCC_miRNA_CDS.csv\") %>% select(-X)\n\nmir100 <- mir %>% filter(V1 == \"Cluster_18728\" & V4.y == \"FUN_014449\")\nhead(mir100)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             V1                       V2  V3   V4.x V5 V6   V7   V8 V9    V10\n1 Cluster_18728 ptg000009l:287232-304756 142 -20.19  2 21 6523 6548 23 60.87%\n2 Cluster_18728 ptg000009l:287232-304756 143 -22.81  2 21 4426 4451 23 56.52%\n3 Cluster_18728 ptg000009l:287232-304756 144 -20.22  2 18 8317 8339 17 70.59%\n4 Cluster_18728 ptg000009l:287232-304756 144 -21.55  2 18 4411 4433 17 70.59%\n5 Cluster_18728 ptg000009l:287232-304756 144 -21.55  2 18 4519 4541 17 70.59%\n6 Cluster_18728 ptg000009l:287232-304756 145 -20.53  2 21 7954 7979 23 65.22%\n     V11       V4.y    PCC.cor    p_value adjusted_p_value\n1 69.57% FUN_014449 -0.9377878 0.01845238        0.8503098\n2 69.57% FUN_014449 -0.9377878 0.01845238        0.8503098\n3 70.59% FUN_014449 -0.9377878 0.01845238        0.8503098\n4 70.59% FUN_014449 -0.9377878 0.01845238        0.8503098\n5 70.59% FUN_014449 -0.9377878 0.01845238        0.8503098\n6 73.91% FUN_014449 -0.9377878 0.01845238        0.8503098\n```\n:::\n:::\n\n\nThe relevant columns here are **V7** and **V8**. These show, respectively, the **beginning and end position of the predicted binding region** in the gene's scaffold (V2). If these 74 predicted binding locations are actually just extremely similar \"variants\", we'd expect many rows to share very similar V7 and V8 values. When I eyeball the table I *don't* see that trend, but let's check it rigorously to be sure.\n\nUse `IRanges`, a package built to work with genomic intervals/positions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nranges <- IRanges(start = mir100$V7, end = mir100$V8)\n\n# which ranges overlap?\nhits <- findOverlaps(ranges)\n\n# Overlapping row pairs\noverlap_pairs <- as.data.frame(hits)\n# Filter out self-overlaps\noverlap_pairs <- overlap_pairs[overlap_pairs$queryHits != overlap_pairs$subjectHits, ]\n# Remove mirrored pairs\noverlap_pairs <- overlap_pairs[overlap_pairs$queryHits < overlap_pairs$subjectHits, ]\nnrow(overlap_pairs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 30\n```\n:::\n:::\n\n\nFor the 74 putative binding regions, there are 30 instances of region overlap. That means **the majority of regions are distinct** from each other!\n\nTriple-check by plotting (quick and dirty genome browser)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmir100$id <- 1:nrow(mir100)\n\nggplot(mir100, aes(x=V7, xend=V8, y=id, yend=id)) +\n  geom_segment(size=4, color=\"steelblue\") +\n  labs(x=\"Position\", y=\"Interval ID\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nâ„¹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](2025_11_20_DDE_miR100_multiBinds_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "2025_11_20_DDE_miR100_multiBinds_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}