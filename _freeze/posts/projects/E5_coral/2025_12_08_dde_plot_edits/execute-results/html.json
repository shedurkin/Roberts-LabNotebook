{
  "hash": "8c4f9e9ccebd7815b3cff81bbffc72c9",
  "result": {
    "markdown": "---\ntitle: \"Deep Dive Expression: Figure edits\"\nauthor: \"Kathleen Durkin\"\ndate: \"2025-12-08\"\ncategories: [\"E5-coral\"]\nformat:\n  html:\n    toc: true\nexecute: \n  eval: TRUE\nengine: knitr\n---\n\n\nTrying out a circos plot via the `circlize` R package. Hoping to get a figure something like this:\n\n![](./images/image0.jpeg)\n\nFinal plot stored [here](https://github.com/shedurkin/Roberts-LabNotebook/tree/master/posts/projects/E5_coral/output/2025_12_08_dde_plot_edits/circos_plot.png)\n\nLoad libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'dplyr' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(stringr)\nlibrary(circlize)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n========================================\ncirclize version 0.4.17\nCRAN page: https://cran.r-project.org/package=circlize\nGithub page: https://github.com/jokergoo/circlize\nDocumentation: https://jokergoo.github.io/circlize_book/book/\n\nIf you use it in published research, please cite:\nGu, Z. circlize implements and enhances circular visualization\n  in R. Bioinformatics 2014.\n\nThis message can be suppressed by:\n  suppressPackageStartupMessages(library(circlize))\n========================================\n```\n:::\n:::\n\n\nLoad edges files and select only miR-100 targets\n\n\n::: {.cell}\n\n```{.r .cell-code}\nApul_edges <- read.csv(\"https://github.com/urol-e5/deep-dive-expression/raw/refs/heads/main/D-Apul/output/33-Apul-miRNA-mRNA-lncRNA-network/edges_miRNA_mRNA_lncRNA_network_p0.05_unique.csv\", header=TRUE) %>% dplyr::select(-X) %>% filter(source == \"apul-mir-100\")\n\nPeve_edges <- read.csv(\"https://github.com/urol-e5/deep-dive-expression/raw/refs/heads/main/E-Peve/output/31-Peve-miRNA-mRNA-lncRNA-network/edges_miRNA_mRNA_lncRNA_network_p0.05_unique.csv\", header=TRUE) %>% dplyr::select(-X) %>% filter(source == \"peve-mir-100\")\n\nPtuh_edges <- read.csv(\"https://github.com/urol-e5/deep-dive-expression/raw/refs/heads/main/F-Ptuh/output/31-Ptuh-miRNA-mRNA-lncRNA-network/edges_miRNA_mRNA_lncRNA_network_p0.05_unique.csv\", header=TRUE) %>% dplyr::select(-X) %>% filter(source == \"ptuh-mir-100\")\n```\n:::\n\n\nRead in [Hollie's orthogroup analysis](https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/scripts/33-orthofinder_E5.md) output:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh_ortho <- readr::read_tsv(\"https://github.com/urol-e5/timeseries_molecular/raw/1b3da407f438e9ecf6fbc43b083b4b94897f2f99/M-multi-species/output/33-orthologs/shared_orthologs_all_species.tsv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 52280 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (3): Orthogroup, Species, Proteins\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\nAdd column showing whether a given orthogroup contains proteins from all species or only a subset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Standardize species names for simplicity\nh_ortho <- h_ortho %>%\n  mutate(\n    simple_species = case_when(\n      grepl(\"Apulchra\", Species) ~ \"apul\",\n      grepl(\"Porites_evermanni\", Species) ~ \"peve\",\n      grepl(\"Pocillopora_meandrina\", Species) ~ \"ptuh\",\n      TRUE ~ \"other\"\n    )\n  )\n\n# Summarize species presence per orthogroup\nh_ortho_summary <- h_ortho %>%\n  group_by(Orthogroup) %>%\n  summarise(\n    type = case_when(\n      all(c(\"apul\", \"peve\", \"ptuh\") %in% simple_species) ~ \"three_way\",\n      all(c(\"apul\", \"peve\") %in% simple_species) & !(\"ptuh\" %in% simple_species) ~ \"apul_peve\",\n      all(c(\"apul\", \"ptuh\") %in% simple_species) & !(\"peve\" %in% simple_species) ~ \"apul_ptuh\",\n      all(c(\"peve\", \"ptuh\") %in% simple_species) & !(\"apul\" %in% simple_species) ~ \"peve_ptuh\",\n      TRUE ~ \"other\"\n    ),\n    .groups = \"drop\"\n  )\n\n# Join back to original\nh_ortho <- h_ortho %>%\n  left_join(h_ortho_summary, by = \"Orthogroup\")\n```\n:::\n\n\nHuh, looks like Hollie's analysis only outputs orthogroups which contain at least one protein from each species\n\nRead in [Steven's orthogroup analysis](https://github.com/urol-e5/timeseries_molecular/blob/1b3da407f438e9ecf6fbc43b083b4b94897f2f99/M-multi-species/scripts/11.1-orthology.md#L4) output:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ns_ortho <- read.csv(\"https://github.com/urol-e5/timeseries_molecular/raw/refs/heads/main/M-multi-species/output/11-orthology-analysis/ortholog_groups.csv\", header=TRUE)\n```\n:::\n\n\nAnnotate each edges file with orthogroup info from both analyses\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Annotate each target with orthogroup type\nApul_edges_ortho <- Apul_edges %>%\n  rowwise() %>%\n  mutate(\n    h_ortho_type = {\n      match_row <- h_ortho %>%\n        filter(str_detect(Proteins, fixed(target)))\n      if(nrow(match_row) > 0) {\n        # If multiple matches, pick the first\n        match_row$type[1]\n      } else {\n        \"none\"\n      }\n    },\n    s_ortho_type = {\n      match_row <- s_ortho %>%\n        filter(str_detect(apul, fixed(target)))\n      if(nrow(match_row) > 0) {\n        # If multiple matches, pick the first\n        match_row$type[1]\n      } else {\n        \"none\"\n      }\n    }\n  ) %>%\n  mutate(species = \"Apul\") %>%\n  ungroup()\n\nPeve_edges_ortho <- Peve_edges %>%\n  rowwise() %>%\n  mutate(\n    h_ortho_type = {\n      match_row <- h_ortho %>%\n        filter(str_detect(Proteins, fixed(target)))\n      if(nrow(match_row) > 0) {\n        # If multiple matches, pick the first\n        match_row$type[1]\n      } else {\n        \"none\"\n      }\n    },\n    s_ortho_type = {\n      match_row <- s_ortho %>%\n        filter(str_detect(peve, fixed(target)))\n      if(nrow(match_row) > 0) {\n        # If multiple matches, pick the first\n        match_row$type[1]\n      } else {\n        \"none\"\n      }\n    }\n  ) %>%\n  mutate(species = \"Peve\") %>%\n  ungroup()\n\nPtuh_edges_ortho <- Ptuh_edges %>%\n  rowwise() %>%\n  mutate(\n    h_ortho_type = {\n      match_row <- h_ortho %>%\n        filter(str_detect(Proteins, fixed(target)))\n      if(nrow(match_row) > 0) {\n        # If multiple matches, pick the first\n        match_row$type[1]\n      } else {\n        \"none\"\n      }\n    },\n    s_ortho_type = {\n      match_row <- s_ortho %>%\n        filter(str_detect(ptua, fixed(target)))\n      if(nrow(match_row) > 0) {\n        # If multiple matches, pick the first\n        match_row$type[1]\n      } else {\n        \"none\"\n      }\n    }\n  ) %>%\n  mutate(species = \"Ptuh\") %>%\n  ungroup()\n```\n:::\n\n\nSince Steven's includes the possibility of orthologs in species subsets (e.g. genes shared between only A. pulchra and P. evermanni), I'll use his ortholog set now for plotting.\n\n## CIRCOS plot\n\nNote: Holy crappoly this plot was exceedingly difficult to put together, even when using ChatGPT and Claude Sonnet 4.5 for help -- I was troubleshooting problems for *hours*. **But**, once I tried using Lucas's paid version (Claude Opus 4.5, integrated into VS code terminal, which he has for his work as a software developer), the agent was able to immediately generate exactly what I was envisioning and make requested changes with no back-and-forth or error handling on my end -- holy jinkies Claude Opus is powerful!\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- rbind(Apul_edges_ortho, Peve_edges_ortho, Ptuh_edges_ortho)\n\n# Add target_type column to distinguish lncRNA from genes\n# Also fix any typos in s_ortho_type (ptua -> ptuh)\ndata <- data %>%\n  mutate(\n    target_type = ifelse(grepl(\"^lncRNA_\", target), \"lncRNA\", \"gene\"),\n    s_ortho_type = case_when(\n      s_ortho_type == \"apul_ptua\" ~ \"apul_ptuh\",\n      s_ortho_type == \"peve_ptua\" ~ \"peve_ptuh\",\n      TRUE ~ s_ortho_type\n    )\n  )\n\n# Define the segment order and which species appear in each\n# We'll have segments for both lncRNA (left half) and genes (right half)\nsegment_info <- list(\n  # lncRNA segments (left half of circle)\n  \"lnc_all_3\" = list(\n    label = \"All 3\",\n    species = c(\"Apul\", \"Peve\", \"Ptuh\"),\n    ortho_type = \"three_way\",\n    target_type = \"lncRNA\"\n  ),\n  \"lnc_apul_peve\" = list(\n    label = \"Apul+Peve\",\n    species = c(\"Apul\", \"Peve\"),\n    ortho_type = \"apul_peve\",\n    target_type = \"lncRNA\"\n  ),\n  \"lnc_peve_ptuh\" = list(\n    label = \"Peve+Ptuh\",\n    species = c(\"Peve\", \"Ptuh\"),\n    ortho_type = \"peve_ptuh\",\n    target_type = \"lncRNA\"\n  ),\n  \"lnc_apul_ptuh\" = list(\n    label = \"Apul+Ptuh\",\n    species = c(\"Apul\", \"Ptuh\"),\n    ortho_type = \"apul_ptuh\",\n    target_type = \"lncRNA\"\n  ),\n  \"lnc_apul_only\" = list(\n    label = \"Apul\",\n    species = c(\"Apul\"),\n    ortho_type = \"none\",\n    target_type = \"lncRNA\"\n  ),\n  \"lnc_peve_only\" = list(\n    label = \"Peve\",\n    species = c(\"Peve\"),\n    ortho_type = \"none\",\n    target_type = \"lncRNA\"\n  ),\n  \"lnc_ptuh_only\" = list(\n    label = \"Ptuh\",\n    species = c(\"Ptuh\"),\n    ortho_type = \"none\",\n    target_type = \"lncRNA\"\n  ),\n  # Gene segments (right half of circle)\n  \"gene_all_3\" = list(\n    label = \"All 3\",\n    species = c(\"Apul\", \"Peve\", \"Ptuh\"),\n    ortho_type = \"three_way\",\n    target_type = \"gene\"\n  ),\n  \"gene_apul_peve\" = list(\n    label = \"Apul+Peve\",\n    species = c(\"Apul\", \"Peve\"),\n    ortho_type = \"apul_peve\",\n    target_type = \"gene\"\n  ),\n  \"gene_peve_ptuh\" = list(\n    label = \"Peve+Ptuh\",\n    species = c(\"Peve\", \"Ptuh\"),\n    ortho_type = \"peve_ptuh\",\n    target_type = \"gene\"\n  ),\n  \"gene_apul_ptuh\" = list(\n    label = \"Apul+Ptuh\",\n    species = c(\"Apul\", \"Ptuh\"),\n    ortho_type = \"apul_ptuh\",\n    target_type = \"gene\"\n  ),\n  \"gene_apul_only\" = list(\n    label = \"Apul\",\n    species = c(\"Apul\"),\n    ortho_type = \"none\",\n    target_type = \"gene\"\n  ),\n  \"gene_peve_only\" = list(\n    label = \"Peve\",\n    species = c(\"Peve\"),\n    ortho_type = \"none\",\n    target_type = \"gene\"\n  ),\n  \"gene_ptuh_only\" = list(\n    label = \"Ptuh\",\n    species = c(\"Ptuh\"),\n    ortho_type = \"none\",\n    target_type = \"gene\"\n  )\n)\n\n# Calculate segment sizes based on actual data\ncalc_segment_sizes <- function(data, segment_info) {\n  sizes <- list()\n\n  for (seg_name in names(segment_info)) {\n    seg <- segment_info[[seg_name]]\n\n    if (seg$ortho_type == \"none\") {\n      # Species-specific: filter by species and target type\n      n <- data %>%\n        filter(s_ortho_type == \"none\",\n               species %in% seg$species,\n               target_type == seg$target_type) %>%\n        select(target) %>% distinct() %>% nrow()\n    } else {\n      # Conserved: filter by ortho type and target type\n      n <- data %>%\n        filter(s_ortho_type == seg$ortho_type,\n               target_type == seg$target_type) %>%\n        select(target) %>% distinct() %>% nrow()\n    }\n    sizes[[seg_name]] <- max(n, 1)  # Minimum size of 1 for visual consistency\n  }\n\n  return(sizes)\n}\n\n# Create improved circos plot with lncRNA/gene split\ncreate_circos_plot_v2 <- function(data) {\n\n  # Species order (outer to inner): Apul, Peve, Ptuh\n  species_order <- c(\"Apul\", \"Peve\", \"Ptuh\")\n\n  # Calculate segment sizes\n  seg_sizes <- calc_segment_sizes(data, segment_info)\n\n  # Define sector order: lncRNA segments first (will be left half), then gene segments (right half)\n  lnc_segments <- c(\"lnc_all_3\", \"lnc_apul_peve\", \"lnc_peve_ptuh\", \"lnc_apul_ptuh\",\n                    \"lnc_apul_only\", \"lnc_peve_only\", \"lnc_ptuh_only\")\n  gene_segments <- c(\"gene_all_3\", \"gene_apul_peve\", \"gene_peve_ptuh\", \"gene_apul_ptuh\",\n                     \"gene_apul_only\", \"gene_peve_only\", \"gene_ptuh_only\")\n\n  # Filter to only segments with data\n  lnc_segments <- lnc_segments[sapply(lnc_segments, function(s) {\n    seg <- segment_info[[s]]\n    if (seg$ortho_type == \"none\") {\n      nrow(data %>% filter(s_ortho_type == \"none\", species %in% seg$species, target_type == \"lncRNA\")) > 0\n    } else {\n      nrow(data %>% filter(s_ortho_type == seg$ortho_type, target_type == \"lncRNA\")) > 0\n    }\n  })]\n\n  gene_segments <- gene_segments[sapply(gene_segments, function(s) {\n    seg <- segment_info[[s]]\n    if (seg$ortho_type == \"none\") {\n      nrow(data %>% filter(s_ortho_type == \"none\", species %in% seg$species, target_type == \"gene\")) > 0\n    } else {\n      nrow(data %>% filter(s_ortho_type == seg$ortho_type, target_type == \"gene\")) > 0\n    }\n  })]\n\n  # All sectors in order\n  all_sectors <- c(lnc_segments, gene_segments)\n\n  if (length(all_sectors) == 0) {\n    message(\"No data to plot\")\n    return(invisible(NULL))\n  }\n\n  # Build xlims\n  xlims <- list()\n  for (seg_name in all_sectors) {\n    xlims[[seg_name]] <- c(0, seg_sizes[[seg_name]])\n  }\n\n  # Initialize circos\n  circos.clear()\n\n  # Calculate gap degrees - larger gaps between lncRNA and gene halves\n  n_lnc <- length(lnc_segments)\n  n_gene <- length(gene_segments)\n  n_total <- n_lnc + n_gene\n\n  # Create gap vector: small gaps within each half, large gap between halves\n  gap_degrees <- rep(4, n_total)\n  if (n_lnc > 0 && n_gene > 0) {\n    gap_degrees[n_lnc] <- 25  # Gap after last lncRNA segment (before genes)\n    gap_degrees[n_total] <- 25  # Gap after last gene segment (before lncRNA)\n  }\n\n  circos.par(\n    start.degree = 90,\n    gap.degree = gap_degrees,\n    track.margin = c(0.02, 0.02),\n    cell.padding = c(0.02, 0.1, 0.02, 0.1)\n  )\n\n  circos.initialize(\n    factors = factor(all_sectors, levels = all_sectors),\n    xlim = do.call(rbind, xlims[all_sectors])\n  )\n\n  # Colors\n  highlight_col <- rgb(0.6, 0.85, 1, 0.6)  # Light blue for conserved\n  no_highlight_col <- rgb(0.95, 0.95, 0.95, 1)  # Light grey for species-specific\n  pos_col <- rgb(0.2, 0.7, 0.2, 0.9)  # Green for positive PCC\n  neg_col <- rgb(0.9, 0.4, 0.6, 0.9)  # Pink for negative PCC\n  border_col <- rgb(0.3, 0.5, 0.7, 1)  # Blue border\n\n  # Create 3 tracks (one per species, outer to inner)\n  for (sp_idx in 1:3) {\n    sp <- species_order[sp_idx]\n\n    circos.track(\n      factors = factor(all_sectors, levels = all_sectors),\n      ylim = c(0, 1),\n      track.height = 0.15,\n      bg.border = \"grey60\",\n      bg.lwd = 1.5,\n      panel.fun = function(x, y) {\n        sector_name <- CELL_META$sector.index\n        seg <- segment_info[[sector_name]]\n\n        # Check if this species appears in this segment\n        sp_in_segment <- sp %in% seg$species\n\n        # Background color\n        if (sp_in_segment && seg$ortho_type != \"none\") {\n          bg_col <- highlight_col\n          border <- border_col\n        } else if (sp_in_segment) {\n          bg_col <- no_highlight_col\n          border <- \"grey60\"\n        } else {\n          bg_col <- \"white\"\n          border <- \"grey80\"\n        }\n\n        # Draw background rectangle\n        circos.rect(\n          CELL_META$xlim[1], 0,\n          CELL_META$xlim[2], 1,\n          col = bg_col,\n          border = border,\n          lwd = 1.5\n        )\n\n        # Plot points if species is in segment\n        if (sp_in_segment) {\n          # Get targets for this segment\n          if (seg$ortho_type == \"none\") {\n            seg_data <- data %>%\n              filter(species == sp,\n                     s_ortho_type == \"none\",\n                     target_type == seg$target_type) %>%\n              distinct(target, .keep_all = TRUE)\n          } else {\n            seg_data <- data %>%\n              filter(species == sp,\n                     s_ortho_type == seg$ortho_type,\n                     target_type == seg$target_type) %>%\n              distinct(target, .keep_all = TRUE)\n          }\n\n          if (nrow(seg_data) > 0) {\n            n_points <- nrow(seg_data)\n            if (n_points == 1) {\n              x_positions <- CELL_META$xlim[2] / 2\n            } else {\n              x_positions <- seq(0.5, CELL_META$xlim[2] - 0.5, length.out = n_points)\n            }\n\n            for (i in 1:n_points) {\n              pt_col <- ifelse(seg_data$PCC_direction[i] > 0, pos_col, neg_col)\n              circos.points(\n                x_positions[i], 0.5,\n                col = pt_col,\n                pch = 21,\n                bg = pt_col,\n                cex = 1.5\n              )\n            }\n          }\n        }\n      }\n    )\n  }\n\n  # Add segment labels on the outside\n  for (seg_name in all_sectors) {\n    seg <- segment_info[[seg_name]]\n\n    circos.text(\n      x = mean(xlims[[seg_name]]),\n      y = 1.8,\n      sector.index = seg_name,\n      track.index = 1,\n      labels = seg$label,\n      facing = \"bending.outside\",\n      niceFacing = TRUE,\n      cex = 0.7,\n      font = 2,\n      col = \"grey30\"\n    )\n  }\n\n  # Add \"lncRNA\" and \"Genes\" labels for each half\n  # These need to be positioned at the center of each half\n  if (n_lnc > 0) {\n    # Get middle lncRNA segment for positioning\n    mid_lnc <- lnc_segments[ceiling(n_lnc / 2)]\n    circos.text(\n      x = mean(xlims[[mid_lnc]]),\n      y = 2.8,\n      sector.index = mid_lnc,\n      track.index = 1,\n      labels = \"lncRNA Targets\",\n      facing = \"bending.outside\",\n      niceFacing = TRUE,\n      cex = 1.1,\n      font = 2,\n      col = \"darkblue\"\n    )\n  }\n\n  if (n_gene > 0) {\n    # Get middle gene segment for positioning\n    mid_gene <- gene_segments[ceiling(n_gene / 2)]\n    circos.text(\n      x = mean(xlims[[mid_gene]]),\n      y = 2.8,\n      sector.index = mid_gene,\n      track.index = 1,\n      labels = \"Gene Targets\",\n      facing = \"bending.outside\",\n      niceFacing = TRUE,\n      cex = 1.1,\n      font = 2,\n      col = \"darkred\"\n    )\n  }\n\n  # Add species labels in the center\n  text(0, 0.08, \"Apul\", font = 2, cex = 1.0, col = \"grey30\")\n  text(0, 0, \"Peve\", font = 2, cex = 1.0, col = \"grey30\")\n  text(0, -0.08, \"Ptuh\", font = 2, cex = 1.0, col = \"grey30\")\n\n  # Add legend\n  legend(\n    \"bottomright\",\n    legend = c(\"Positive PCC\", \"Negative PCC\", \"Conserved region\"),\n    pch = c(21, 21, 22),\n    pt.bg = c(pos_col, neg_col, highlight_col),\n    col = c(pos_col, neg_col, border_col),\n    pt.cex = c(1.5, 1.5, 2.2),\n    bty = \"n\",\n    cex = 0.85\n  )\n\n  # Add title\n  title(\"miR-100 Targets by Conservation\", line = -1, cex.main = 1.3)\n\n  circos.clear()\n}\n\n# Create the plot\ncreate_circos_plot_v2(data)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_apul_only',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'lnc_apul_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 4 points are out of plotting region in sector 'lnc_apul_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_peve_only',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'lnc_peve_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 4 points are out of plotting region in sector 'lnc_peve_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_ptuh_only',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'lnc_ptuh_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 4 points are out of plotting region in sector 'lnc_ptuh_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_all_3', track\n'1'.\nNote: 1 point is out of plotting region in sector 'gene_all_3', track\n'1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 5 points are out of plotting region in sector 'gene_all_3', track\n'1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_only',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 4 points are out of plotting region in sector 'gene_apul_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_peve_only',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_peve_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 4 points are out of plotting region in sector 'gene_peve_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_ptuh_only',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_ptuh_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 4 points are out of plotting region in sector 'gene_ptuh_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_peve_only',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'lnc_peve_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 14 points are out of plotting region in sector 'lnc_peve_only',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 12 points are out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output-display}\n![](2025_12_08_dde_plot_edits_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Version 3: Compact layout with overlapping unconserved targets\n\nThis version combines all species-specific (unconserved) targets into a single segment per target type, where each species' targets overlap in the same angular space but are not shaded to indicate conservation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set margins to allow room for outer labels\npar(mar = c(2, 2, 4, 2))\n\n# Define segments for compact version - unconserved targets share same segment\nsegment_info_v3 <- list(\n  # lncRNA segments (left half of circle)\n  \"lnc_all_3\" = list(\n    label = \"All 3\",\n    species = c(\"Apul\", \"Peve\", \"Ptuh\"),\n    ortho_type = \"three_way\",\n    target_type = \"lncRNA\",\n    conserved = TRUE\n  ),\n  \"lnc_apul_peve\" = list(\n    label = \"Apul+Peve\",\n    species = c(\"Apul\", \"Peve\"),\n    ortho_type = \"apul_peve\",\n    target_type = \"lncRNA\",\n    conserved = TRUE\n  ),\n  \"lnc_peve_ptuh\" = list(\n    label = \"Peve+Ptuh\",\n    species = c(\"Peve\", \"Ptuh\"),\n    ortho_type = \"peve_ptuh\",\n    target_type = \"lncRNA\",\n    conserved = TRUE\n  ),\n  \"lnc_apul_ptuh\" = list(\n    label = \"Apul+Ptuh\",\n    species = c(\"Apul\", \"Ptuh\"),\n    ortho_type = \"apul_ptuh\",\n    target_type = \"lncRNA\",\n    conserved = TRUE\n  ),\n  \"lnc_unconserved\" = list(\n    label = \"Unconserved\",\n    species = c(\"Apul\", \"Peve\", \"Ptuh\"),\n    ortho_type = \"none\",\n    target_type = \"lncRNA\",\n    conserved = FALSE\n  ),\n  # Gene segments (right half of circle)\n  \"gene_all_3\" = list(\n    label = \"All 3\",\n    species = c(\"Apul\", \"Peve\", \"Ptuh\"),\n    ortho_type = \"three_way\",\n    target_type = \"gene\",\n    conserved = TRUE\n  ),\n  \"gene_apul_peve\" = list(\n    label = \"Apul+Peve\",\n    species = c(\"Apul\", \"Peve\"),\n    ortho_type = \"apul_peve\",\n    target_type = \"gene\",\n    conserved = TRUE\n  ),\n  \"gene_peve_ptuh\" = list(\n    label = \"Peve+Ptuh\",\n    species = c(\"Peve\", \"Ptuh\"),\n    ortho_type = \"peve_ptuh\",\n    target_type = \"gene\",\n    conserved = TRUE\n  ),\n  \"gene_apul_ptuh\" = list(\n    label = \"Apul+Ptuh\",\n    species = c(\"Apul\", \"Ptuh\"),\n    ortho_type = \"apul_ptuh\",\n    target_type = \"gene\",\n    conserved = TRUE\n  ),\n  \"gene_unconserved\" = list(\n    label = \"Unconserved\",\n    species = c(\"Apul\", \"Peve\", \"Ptuh\"),\n    ortho_type = \"none\",\n    target_type = \"gene\",\n    conserved = FALSE\n  )\n)\n\n# Calculate segment sizes for v3 - unconserved segments need max across all species\ncalc_segment_sizes_v3 <- function(data, segment_info) {\n  sizes <- list()\n\n  for (seg_name in names(segment_info)) {\n    seg <- segment_info[[seg_name]]\n\n    if (seg$ortho_type == \"none\") {\n      # Unconserved: find the max count across all species\n      max_n <- 0\n      for (sp in seg$species) {\n        n <- data %>%\n          filter(s_ortho_type == \"none\",\n                 species == sp,\n                 target_type == seg$target_type) %>%\n          select(target) %>% distinct() %>% nrow()\n        max_n <- max(max_n, n)\n      }\n      sizes[[seg_name]] <- max(max_n, 1)\n    } else {\n      # Conserved: filter by ortho type and target type\n      n <- data %>%\n        filter(s_ortho_type == seg$ortho_type,\n               target_type == seg$target_type) %>%\n        select(target) %>% distinct() %>% nrow()\n      sizes[[seg_name]] <- max(n, 1)\n    }\n  }\n\n  return(sizes)\n}\n\n# Create compact circos plot with overlapping unconserved targets\ncreate_circos_plot_v3 <- function(data) {\n\n # Species order (outer to inner): Peve (most), Apul, Ptuh (fewest)\n  species_order <- c(\"Peve\", \"Apul\", \"Ptuh\")\n\n  # Calculate segment sizes\n  seg_sizes <- calc_segment_sizes_v3(data, segment_info_v3)\n\n  # Define sector order: lncRNA segments first, then gene segments\n  lnc_segments <- c(\"lnc_all_3\", \"lnc_apul_peve\", \"lnc_peve_ptuh\", \"lnc_apul_ptuh\", \"lnc_unconserved\")\n  gene_segments <- c(\"gene_all_3\", \"gene_apul_peve\", \"gene_apul_ptuh\",  \"gene_peve_ptuh\", \"gene_unconserved\")\n\n  # Filter to only segments with data\n  lnc_segments <- lnc_segments[sapply(lnc_segments, function(s) {\n    seg <- segment_info_v3[[s]]\n    if (seg$ortho_type == \"none\") {\n      nrow(data %>% filter(s_ortho_type == \"none\", target_type == \"lncRNA\")) > 0\n    } else {\n      nrow(data %>% filter(s_ortho_type == seg$ortho_type, target_type == \"lncRNA\")) > 0\n    }\n  })]\n\n  gene_segments <- gene_segments[sapply(gene_segments, function(s) {\n    seg <- segment_info_v3[[s]]\n    if (seg$ortho_type == \"none\") {\n      nrow(data %>% filter(s_ortho_type == \"none\", target_type == \"gene\")) > 0\n    } else {\n      nrow(data %>% filter(s_ortho_type == seg$ortho_type, target_type == \"gene\")) > 0\n    }\n  })]\n\n  # All sectors in order\n  all_sectors <- c(lnc_segments, gene_segments)\n\n  if (length(all_sectors) == 0) {\n    message(\"No data to plot\")\n    return(invisible(NULL))\n  }\n\n  # Build xlims\n  xlims <- list()\n  for (seg_name in all_sectors) {\n    xlims[[seg_name]] <- c(0, seg_sizes[[seg_name]])\n  }\n\n  # Initialize circos\n  circos.clear()\n\n  # Calculate gap degrees - larger gaps between lncRNA and gene halves\n  n_lnc <- length(lnc_segments)\n  n_gene <- length(gene_segments)\n  n_total <- n_lnc + n_gene\n\n  # Create gap vector: small gaps within each half, large gap between halves\n  gap_degrees <- rep(3, n_total)\n  if (n_lnc > 0 && n_gene > 0) {\n    gap_degrees[n_lnc] <- 10\n    gap_degrees[n_total] <- 20\n  }\n\n  circos.par(\n    start.degree = 90,\n    gap.degree = gap_degrees,\n    track.margin = c(0.02, 0.02),\n    cell.padding = c(0.02, 0.1, 0.02, 0.1),\n    canvas.xlim = c(-1.4, 1.4),\n    canvas.ylim = c(-1.4, 1.4)\n  )\n\n  circos.initialize(\n    factors = factor(all_sectors, levels = all_sectors),\n    xlim = do.call(rbind, xlims[all_sectors])\n  )\n\n  # Colors\n  highlight_col <- rgb(0.6, 0.85, 1, 0.6)  # Light blue for conserved\n  no_highlight_col <- rgb(0.95, 0.95, 0.95, 1)  # Light grey for unconserved\n  pos_col <- rgb(0.2, 0.7, 0.2, 0.9)  # Green for positive PCC\n  neg_col <- rgb(0.9, 0.4, 0.6, 0.9)  # Pink for negative PCC\n  border_col <- rgb(0.3, 0.5, 0.7, 1)  # Blue border\n\n  # Create 3 tracks (one per species, outer to inner)\n  for (sp_idx in 1:3) {\n    sp <- species_order[sp_idx]\n\n    circos.track(\n      factors = factor(all_sectors, levels = all_sectors),\n      ylim = c(0, 1),\n      track.height = 0.15,\n      bg.border = \"grey60\",\n      bg.lwd = 1.5,\n      panel.fun = function(x, y) {\n        sector_name <- CELL_META$sector.index\n        seg <- segment_info_v3[[sector_name]]\n\n        # For conserved segments, check if species is in the conservation group\n        # For unconserved, all species appear but no highlighting\n        if (seg$conserved) {\n          sp_in_segment <- sp %in% seg$species\n        } else {\n          sp_in_segment <- TRUE  # All species appear in unconserved segment\n        }\n\n        # Background color\n        if (seg$conserved && sp_in_segment) {\n          bg_col <- highlight_col\n          border <- border_col\n        } else if (sp_in_segment) {\n          bg_col <- no_highlight_col\n          border <- \"grey60\"\n        } else {\n          bg_col <- \"white\"\n          border <- \"grey80\"\n        }\n\n        # Draw background rectangle\n        circos.rect(\n          CELL_META$xlim[1], 0,\n          CELL_META$xlim[2], 1,\n          col = bg_col,\n          border = border,\n          lwd = 1.5\n        )\n\n        # Plot points\n        if (seg$ortho_type == \"none\") {\n          # Unconserved: each species plots its own targets\n          seg_data <- data %>%\n            filter(species == sp,\n                   s_ortho_type == \"none\",\n                   target_type == seg$target_type) %>%\n            distinct(target, .keep_all = TRUE)\n        } else if (sp_in_segment) {\n          # Conserved: filter by ortho type\n          seg_data <- data %>%\n            filter(species == sp,\n                   s_ortho_type == seg$ortho_type,\n                   target_type == seg$target_type) %>%\n            distinct(target, .keep_all = TRUE)\n        } else {\n          seg_data <- data.frame()\n        }\n\n        if (nrow(seg_data) > 0) {\n          n_points <- nrow(seg_data)\n          if (n_points == 1) {\n            x_positions <- CELL_META$xlim[2] / 2\n          } else {\n            x_positions <- seq(0.5, CELL_META$xlim[2] - 0.5, length.out = n_points)\n          }\n\n          for (i in 1:n_points) {\n            pt_col <- ifelse(seg_data$PCC_direction[i] > 0, pos_col, neg_col)\n            circos.points(\n              x_positions[i], 0.5,\n              col = pt_col,\n              pch = 21,\n              bg = pt_col,\n              cex = 0.75\n            )\n          }\n\n          # Add count label above the feature points\n          circos.text(\n            x = mean(x_positions),\n            y = 0.85,\n            labels = as.character(n_points),\n            facing = \"bending.inside\",\n            niceFacing = TRUE,\n            cex = 0.75,\n            col = \"black\",\n            font = 2\n          )\n        }\n      }\n    )\n  }\n\n  # Add segment labels on the outside\n  for (seg_name in all_sectors) {\n    seg <- segment_info_v3[[seg_name]]\n\n    circos.text(\n      x = mean(xlims[[seg_name]]),\n      y = 1.8,\n      sector.index = seg_name,\n      track.index = 1,\n      labels = seg$label,\n      facing = \"bending.outside\",\n      niceFacing = TRUE,\n      cex = 0.7,\n      font = 2,\n      col = \"grey30\"\n    )\n  }\n\n  # Add \"lncRNA\" and \"Genes\" labels for each half\n  if (n_lnc > 0) {\n    mid_lnc <- lnc_segments[ceiling(n_lnc / 2)]\n    circos.text(\n      x = mean(xlims[[mid_lnc]]),\n      y = 2.5,\n      sector.index = mid_lnc,\n      track.index = 1,\n      labels = \"lncRNA Targets\",\n      facing = \"bending.outside\",\n      niceFacing = TRUE,\n      cex = 1.0,\n      font = 2,\n      col = \"darkblue\"\n    )\n  }\n\n  if (n_gene > 0) {\n    mid_gene <- gene_segments[ceiling(n_gene / 2)]\n    circos.text(\n      x = mean(xlims[[mid_gene]]),\n      y = 2.5,\n      sector.index = mid_gene,\n      track.index = 1,\n      labels = \"Gene Targets\",\n      facing = \"bending.outside\",\n      niceFacing = TRUE,\n      cex = 1.0,\n      font = 2,\n      col = \"darkred\"\n    )\n  }\n\n  # Add title and species labels in the center (outer to inner: Peve, Apul, Ptuh)\n  text(0, 0.04, \"miR-100 Targets\", font = 2, cex = 1.1, col = \"black\")\n  text(0, -0.04, \"by Conservation\", font = 2, cex = 1.1, col = \"black\")\n  text(-0.09, 0.9, \"Peve\", font = 2, cex = 0.9, col = \"grey30\")\n  text(-0.09, 0.71, \"Apul\", font = 2, cex = 0.9, col = \"grey30\")\n  text(-0.09, 0.53, \"Ptuh\", font = 2, cex = 0.9, col = \"grey30\")\n\n  # Add legend\n  legend(\n    \"bottomright\",\n    legend = c(\"Positive PCC\", \"Negative PCC\", \"Conserved region\"),\n    pch = c(21, 21, 22),\n    pt.bg = c(pos_col, neg_col, highlight_col),\n    col = c(pos_col, neg_col, border_col),\n    pt.cex = c(1.5, 1.5, 2.2),\n    bty = \"n\",\n    cex = 0.85\n  )\n\n  circos.clear()\n}\n\n# Create the compact plot\ncreate_circos_plot_v3(data)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 11 points are out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_all_3', track\n'1'.\nNote: 1 point is out of plotting region in sector 'gene_all_3', track\n'1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 5 points are out of plotting region in sector 'gene_all_3', track\n'1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_unconserved',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 11 points are out of plotting region in sector\n'gene_unconserved', track '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 14 points are out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 12 points are out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output-display}\n![](2025_12_08_dde_plot_edits_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Save to png\npng(\"output/2025_12_08_dde_plot_edits/circos_plot.png\", width = 2000, height = 2000, res = 300)\ncreate_circos_plot_v3(data)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 11 points are out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_all_3', track\n'1'.\nNote: 1 point is out of plotting region in sector 'gene_all_3', track\n'1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 5 points are out of plotting region in sector 'gene_all_3', track\n'1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_apul_peve',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 9 points are out of plotting region in sector 'gene_peve_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_unconserved',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 11 points are out of plotting region in sector\n'gene_unconserved', track '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 14 points are out of plotting region in sector 'lnc_unconserved',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\nNote: 1 point is out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNote: 12 points are out of plotting region in sector 'gene_apul_ptuh',\ntrack '1'.\n```\n:::\n\n```{.r .cell-code}\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npng \n  2 \n```\n:::\n:::\n",
    "supporting": [
      "2025_12_08_dde_plot_edits_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}